<!DOCTYPE html>
<html lang="en">
  
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="description" content="">
    <meta name="author" content="">
   
    <title>47SMSG - Stock Market Simulation Game</title>
  
    
    
	<!-- Bootstrap 4.0-->
	<link rel="stylesheet" href="../assets/vendor_components/bootstrap/dist/css/bootstrap.css">
    
	<!--amcharts -->
	<link href="../assets/www.amcharts.com/lib/3/plugins/export/export.css" rel="stylesheet" type="text/css" />
	<link rel="stylesheet" href="../assets/vendor_components/chartist-js-develop/chartist.css">
	<link rel="stylesheet" href="../assets/vendor_components/bootstrap-switch/switch.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css" rel="stylesheet" type="text/css" />
	<link rel="stylesheet" href="css/bootstrap-extend.css">
	<link rel="stylesheet" href="css/master_style.css">
	<link rel="stylesheet" href="css/skins/_all-skins.css">

  </head>

<body class="hold-transition skin-blue sidebar-mini">
<div class="wrapper">

  <header class="main-header">
    <!-- Logo -->
    <a href="index-2.html" class="logo">
      <!-- mini logo for sidebar mini 50x50 pixels -->
	  <b class="logo-mini">
		  <span class="light-logo"><img src="../images/logo-light.png" alt="logo"></span>
		  <span class="dark-logo"><img src="../images/logo-dark.png" alt="logo"></span>
	  </b>
      <!-- logo for regular state and mobile devices -->
      <span class="logo-lg">
		  <img src="images/Logo.png" alt="logo" style=""" class="light-logo">
	  	  <img src="../images/logo-dark-text.png" alt="logo" class="dark-logo">
	  </span>
    </a> 
    <!-- Header Navbar -->
    <nav class="navbar navbar-static-top">
      <!-- Sidebar toggle button-->
      <a href="#" class="sidebar-toggle" data-toggle="push-menu" role="button">
        <span class="sr-only">Toggle navigation</span>
      </a>

      <div class="navbar-custom-menu">
        <ul class="nav navbar-nav">
		  <!-- User Account -->
          <li class="dropdown user user-menu">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
              <sapn id="user">The 47</sapn>
            </a>
            <ul class="dropdown-menu scale-up">
              <!-- User image -->
              <!-- Menu Body -->
            </ul>
          </li>
        </ul>
      </div>
    </nav>
  </header>
  
  <!-- Left side column. contains the logo and sidebar -->
  <aside class="main-sidebar">
    <!-- sidebar -->
    <section class="sidebar">
      <!-- Sidebar user panel -->
      <div class="user-panel">
		 <div class="ulogo">
			 <a href="index.html">
			   <img src="../images/Logo.png" alt="logo" style="width:165px;" class="light-logo">
			 
			</a>
		</div>
      </div>
      <!-- sidebar menu -->
      <ul class="sidebar-menu" data-widget="tree">
		<li class="nav-devider"></li>
        <li class="header nav-small-cap">PERSONAL</li>
        <li class="active">
          <a href="index.html">
            <i class="fa fa-home"></i> <span>Dashboard</span>
            <span class="pull-right-container">
              <i class="fa fa-angle-right pull-right"></i>
            </span>
          </a>
        </li>
      </ul>
    </section>
  </aside>

  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->
   

    <!-- Main content -->
    <section class="content">
		
		<div class="row">
      
			<div class="col-lg-4 col-12">
          <div class="box box-solid bg-black">
              <div class="box-header with-border">
                <h4 class="box-title">Leader Board</h4>
                <div class="box-body p-0">
						
					</div>
              </div>
              <div class="box-body">					  
                <div class="table-responsive">
							<table id="players" class="table table-bordered no-margin">
							  <thead>					
								<tr class="bg-pale-dark">
								  <th>Name</th>
								  <th>Stocks</th>
								  <th>Account</th>
								</tr>
							  </thead>
							  <tbody>
								
							  </tbody>
							</table>
						</div>
                </div>
            </div>
				<div class="box box-solid bg-black">
					<div class="box-header with-border">
						<h4 class="box-title">Live Stock Prices</h4>
						<ul class="box-controls pull-right">
								</ul>
					</div>
					<div class="box-body p-0">
					  <div id="companies" class="media-list media-list-hover media-list-divided">
						
					  </div>
				  </div>
				</div>
				<div class="box box-solid bg-black">
              <div class="box-header with-border">
                <h4 class="box-title">Stock Belongings</h4>
                <div class="box-body p-0">
						
					</div>
              </div>
              <div class="box-body">					  
                <div class="table-responsive">
							<table id="user_shares" class="table table-bordered no-margin">
							  <thead>					
								<tr class="bg-pale-dark">
								  <th>Stock</th>
								  <th>Share Count</th>
								  <th>Share Value</th>
								</tr>
							  </thead>
							  <tbody>
								
							  </tbody>
							</table>
						</div>
                </div>
            </div>
				<div class="box box-solid bg-black">
              <div class="box-header with-border">
                <h4 class="box-title">Analysis Suggestions</h4>
                <div class="box-body p-0">
						
					</div>
              </div>
              <div class="box-body">					  
                <div class="table-responsive">
							<table id="suggesstions" class="table table-bordered no-margin">
							  <thead>					
								<tr class="bg-pale-dark">
								  <th>Stock</th>
								  <th>Action</th>
								</tr>
							  </thead>
							  <tbody>
								
							  </tbody>
							</table>
						</div>
                </div>
            </div>
			</div>
			<div class="col-lg-8 col-12">			
				
				<div class="row">
					<div class="col-md-4 col-6">
						<div class="box box-body pull-up bg-warning bg-deathstar-white">
						  <div class="flexbox">
							<span class="fa fa-money font-size-40"></span>
							<span id="accountBalance" class="font-weight-200 font-size-26"></span>
						  </div>
						  <div class="text-right">Bank Balance</div>
						</div>
					</div>
					<div class="col-md-4 col-6">
						<div class="box box-body pull-up bg-danger bg-deathstar-white">
						  <div class="flexbox">
							<span class="fa fa-clock-o font-size-40"></span>
							<span id="this_round" class="font-weight-200 font-size-26"></span>
						  </div>
						  <div class="text-right">Current Round</div>
						</div>
					</div>
					<div class="col-md-4 col-6">
						<div class="box box-body pull-up bg-success bg-deathstar-white">
						  <div class="flexbox">
							<span class="fa fa-trophy font-size-40"></span>
							<span id="stockValue" class="font-weight-200 font-size-26"></span>
						  </div>
						  <div class="text-right">Stock Shares Value</div>
						</div>
					</div>
			
				</div>
        <div class="box">
            <div class="box-header with-border">
              <h4 class="box-title">Stock History</h4>
              
            </div>
            <div class="box-body">					  
              <div class="table-responsive">
							<table id="stock_history" class="table table-bordered no-margin">
							  <thead>					
								
							  </thead>
							  <tbody>
								
							  </tbody>
							</table>
						</div>
              </div>
          </div>

          <div class="row">
          <div class="col-lg-6 col-12">
              <div class="box bg-danger box-solid">
                <div class="box-header with-border">
                <h4 class="box-title">Buy Shares</h4>
                <ul class="box-controls pull-right">
                   </ul>
                </div>
    
                <div class="box-content">
                <div class="box-body">
                  <form action="http://html-templates.multipurposethemes.com/bootstrap-4/admin/crypto-admin/business-analytics-dashboard/pages/forms/premade.html" method="post" onsubmit="return false;">					
                  <div class="form-group row">
                    <label class="col-12" for="login1-username">Select a Company</label>
                    <div class="col-12">
                      <select id="company" name="company" class="form-control">
                        
                      </select>
                   
                    </div>
                  </div>
                  <div class="form-group row">
                    <label class="col-12" for="lock1-password1">Amount</label>
                    <div class="col-12">
                      <input type="number" class="form-control" id="amount" name="amount" >
                    </div>
                  </div>
                  
                  <div class="form-group row mb-0">
                    <div class="col-12">
                      <button id="buy_button" type="button" class="btn btn-danger">
                        <i class="fa fa-arrow-right mr-5"></i> BUY
                      </button>
                    </div>
                  </div>
                  </form>
                </div>
                </div>
              </div>			
            </div>

            <div class="col-lg-6 col-12">
                <div class="box bg-danger box-solid">
                  <div class="box-header with-border">
                  <h4 class="box-title">Sell Shares</h4>
                
                  </div>
      
                  <div class="box-content">
                  <div class="box-body">
                    <form action="http://html-templates.multipurposethemes.com/bootstrap-4/admin/crypto-admin/business-analytics-dashboard/pages/forms/premade.html" method="post" onsubmit="return false;">					
                    <div class="form-group row">
                        <label class="col-12" for="login1-username">Select a Company</label>
                        <div class="col-12">
                          <select name="sellcompany" id="sellcompany" class="form-control">
                            
                          </select>
                       
                        </div>
                    </div>
                    <div class="form-group row">
                        <label class="col-12" for="lock1-password1">Amount</label>
                        <div class="col-12">
                          <select  class="form-control" id="sellamount" name="amount" ></select>
                        </div>
                    </div>
                    <div class="form-group row mb-0">
                      <div class="col-12">
                        <button id="sell_button" type="button" class="btn btn-danger">
                          <i class="fa fa-arrow-right mr-5"></i> SELL
                        </button>
                      </div>
                    </div>
                    </form>
                  </div>
                  </div>
                </div>			
              </div>
            </div>

				<div class="box box-solid bg-black">
					<div class="box-header with-border">
					  <h4 class="box-title">Share Transactions History</h4>
						
					</div>
					<div class="box-body">
						<div class="table-responsive">
							<table id="share_records" class="table table-bordered no-margin">
							  <thead>					
								<tr class="bg-pale-dark">
								  <th>Company</th>
								  <th>Stock Amount</th>
								  <th>Transaction Amount</th>
								  <th>Activity</th>
								  <th>Time</th>
								</tr>
							  </thead>
							  <tbody>
								
							  </tbody>
							</table>
						</div>
					</div>
					<!-- /.box-body -->
				  </div>
				  <div class="box box-solid bg-black">
					<div class="box-header with-border">
					  <h4 class="box-title">Recent Bank Account Activities</h4>
						
					</div>
					<div class="box-body">
						<div class="table-responsive">
							<table id="account_records" class="table table-bordered no-margin">
							  <thead>					
								<tr class="bg-pale-dark">
								  <th>Time</th>
								  <th>Transaction Amount</th>
								  <th>Activity</th>
								  <th>Balance After</th>
								</tr>
							  </thead>
							  <tbody>
								
							  </tbody>
							</table>
						</div>
					</div>
					<!-- /.box-body -->
				  </div>
					
				</div>			
			</div>			
		</div>
	</section>
    <!-- /.content -->
  </div>
  <!-- /.content-wrapper -->
  
  <footer class="main-footer">
    <div class="pull-right d-none d-sm-inline-block">
        <ul class="nav nav-primary nav-dotted nav-dot-separated justify-content-center justify-content-md-end">
		
		</ul>
    </div>
	  &copy; 2018 . All Rights Reserved.
  </footer>

</div>
<!-- ./wrapper -->
  	
	 
	  
	<!-- jQuery 3 -->
	<script src="../assets/vendor_components/jquery/dist/jquery.js"></script>
	
	<!-- popper -->
	<script src="../assets/vendor_components/popper/dist/popper.min.js"></script>
	
	<!-- Bootstrap 4.0-->
	<script src="../assets/vendor_components/bootstrap/dist/js/bootstrap.js"></script>
	
	<!-- Slimscroll -->
	<script src="../assets/vendor_components/jquery-slimscroll/jquery.slimscroll.js"></script>
	
	<!-- FastClick -->
	<script src="../assets/vendor_components/fastclick/lib/fastclick.js"></script>
	
	<!-- ChartJS -->
	<script src="../assets/vendor_components/chart.js-master/Chart.min.js"></script>
	
	<!-- Chartist  -->
	<script src="../assets/vendor_components/chartist-js-develop/chartist.min.js"></script>
	
    <!--amcharts charts -->
	<script src="../assets/www.amcharts.com/lib/3/amcharts.js" type="text/javascript"></script>
	<script src="../assets/www.amcharts.com/lib/3/gauge.js" type="text/javascript"></script>
	<script src="../assets/www.amcharts.com/lib/3/serial.js" type="text/javascript"></script>
	<script src="../assets/www.amcharts.com/lib/3/amstock.js" type="text/javascript"></script>
	<script src="../assets/www.amcharts.com/lib/3/pie.js" type="text/javascript"></script>
	<script src="../assets/www.amcharts.com/lib/3/plugins/animate/animate.min.js" type="text/javascript"></script>
	<script src="../assets/www.amcharts.com/lib/3/plugins/export/export.min.js" type="text/javascript"></script>
	<script src="../assets/www.amcharts.com/lib/3/themes/patterns.js" type="text/javascript"></script>
	<script src="../assets/www.amcharts.com/lib/3/themes/light.js" type="text/javascript"></script>		
	
	<!-- This is data table -->
    <script src="../assets/vendor_plugins/DataTables-1.10.15/media/js/jquery.dataTables.min.js"></script>
	
	<!-- DataTables -->
	<script src="../assets/vendor_components/datatables.net/js/jquery.dataTables.min.js"></script>
	<script src="../assets/vendor_components/datatables.net-bs/js/dataTables.bootstrap.min.js"></script>
	

	<script src="js/template.js"></script>
	<script src="js/pages/dashboard.js"></script>
	<script src="js/pages/dashboard-chart.js"></script>
	<script src="js/pages/project-table-dashboard.js"></script>
	<script type="text/javascript">
    $(function(){
    	var host=window.location.host;
    	var user=sessionStorage.getItem("player_name");
    	$("#user").text(user);
    	$.ajax({
            url: "http://"+host+"/47SMSG/rest/game/current-round",
            type: 'GET',
            success: function (res) {
            	console.log(res);
              $("#this_round").text(res);
            },
        });
    	$.ajax({
            url: "http://"+host+"/47SMSG/rest/player-broker/bankdetails/"+user,
            type: 'GET',
            success: function (res) {
               $("#accountBalance").text(res.accountBalance);
            },
        });
    	$.ajax({
            url: "http://"+host+"/47SMSG/rest/player-broker/player-info/"+user,
            type: 'GET',
            success: function (res) {
               $("#stockValue").text(res.stock_value);
            },
        });
    	$("#companies").empty();
    	$("#company").empty();
		$.ajax({
            url: "http://"+host+"/47SMSG/rest/player-broker",
            type: 'GET',
            success: function (res) {
               $.each(res,function(key,company){
            	   $("#companies").append('<a class="media media-single p-10" href="#"><span class="avatar avatar-sm bg-primary">'+company.share_Vlaue+'</span><span class="title">'+company.company_Name+'('+company.company_Sector+')</span></a>');
            	   $("#company").append('<option value="'+company.company_Name+'">'+company.company_Name+'</option>');
            	});
            },
        });
		$("#players > tbody").empty();
		$.ajax({
            url: "http://"+host+"/47SMSG/rest/game/players",
            type: 'GET',
            success: function (res) {
               $.each(res,function(key,player){
            	   $.ajax({
                       url: "http://"+host+"/47SMSG/rest/player-broker/bankdetails/"+player.player_name,
                       type: 'GET',
                       success: function (res) {
                          $("#players > tbody:last-child").append('<tr><td><i class="fa fa-dot-circle-o complete"></i>'+player.player_name+'</td><td>'+player.stock_value+'</td><td>'+res.accountBalance+'</td></tr>');
                       },
                   });
            	   });
            },
        });
		$("#user_shares >tbody").empty();
		$("#sellcompany").empty();
		$.ajax({
            url: "http://"+host+"/47SMSG/rest/game/player-stock/"+user,
            type: 'GET',
            success: function (res) {
            	
               $.each(res,function(key,stock){
            	   $("#sellcompany").append('<option value="'+stock.company+'">'+stock.company+'</option>');
            	   $("#user_shares > tbody:last-child").append('<tr><td>'+stock.company+'</td><td>'+stock.stock_Count+'</td><td>'+stock.stock_Value+'</td></tr>');
               });
            },
        });
		$("#sellcompany").change(function(){
			$("#sellamount").empty();
			if($("#sellcompany :selected").val()!=null){
			$.ajax({
					url: "http://"+host+"/47SMSG/rest/player-broker/stock-count/"+$("#sellcompany :selected").val()+"/"+user,
		            type: 'GET',
		            success: function (res) {
		            	
		            	$("#sellamount").empty();
		               for(i=1;i<=res;i++){
		            	   $("#sellamount").append('<option value="'+i+'">'+i+'</option>');
		            	}
		            },
	        });
			}else{
				alert("Please Select an Stock to sell.")
			}
		});
		
		setInterval(function(){
			$.ajax({
	            url: "http://"+host+"/47SMSG/rest/player-broker/bankdetails/"+user,
	            type: 'GET',
	            success: function (res) {
	               $("#accountBalance").text(res.accountBalance);
	            },
	        });
			$.ajax({
	            url: "http://"+host+"/47SMSG/rest/game/current-round",
	            type: 'GET',
	            success: function (res) {
	            	console.log(res);
	              $("#this_round").text(res);
	            },
	        });
	    	$.ajax({
	            url: "http://"+host+"/47SMSG/rest/player-broker/player-info/"+user,
	            type: 'GET',
	            success: function (res) {
	               $("#stockValue").text(res.stock_value);
	            },
	        });
	    	$("#companies").empty();
			$.ajax({
	            url: "http://"+host+"/47SMSG/rest/player-broker",
	            type: 'GET',
	            success: function (res) {
	               $.each(res,function(key,company){
	            	   $("#companies").append('<a class="media media-single p-10" href="#"><span class="avatar avatar-sm bg-primary">'+company.share_Vlaue+'</span><span class="title">'+company.company_Name+'('+company.company_Sector+')</span></a>');
	            	   });
	            },
	        });
			$("#players > tbody").empty();
			$.ajax({
	            url: "http://"+host+"/47SMSG/rest/game/players",
	            type: 'GET',
	            success: function (res) {
	               $.each(res,function(key,player){
	            	   $.ajax({
	                       url: "http://"+host+"/47SMSG/rest/player-broker/bankdetails/"+player.player_name,
	                       type: 'GET',
	                       success: function (res) {
	                          $("#players > tbody:last-child").append('<tr><td><i class="fa fa-dot-circle-o complete"></i>'+player.player_name+'</td><td>'+player.stock_value+'</td><td>'+res.accountBalance+'</td></tr>');
	                       },
	                   });
	            	   });
	            },
	        });
			$("#suggesstions > tbody").empty();
    		$.ajax({
                url: "http://"+host+"/47SMSG/rest/analyst/stocks",
                type: 'GET',
                success: function (res) {
                   $.each(res,function(key,recom){
                	   $("#suggesstions > tbody:last-child").append('<tr><td>'+recom.company_name+'</td><td>'+ recom.recommend +'</td></tr>');
                   });
                },
            });
    		$("#share_records >tbody").empty();
    		$.ajax({
                url: "http://"+host+"/47SMSG/rest/player-broker/stocktransactions/"+user,
                type: 'GET',
                success: function (res) {
                   $.each(res,function(key,transaction){
                	   $("#share_records > tbody:last-child").append('<tr><td>'+transaction.company+'</td><td>'+transaction.share_amount+'</td><td>'+transaction.transaction_amount+'</td><td>'+transaction.transaction_type+'</td><td>'+transaction.trans_time+'</td></tr>');
                   });
                },
            });
    		$("#account_records >tbody").empty();
    		$.ajax({
                url: "http://"+host+"/47SMSG/rest/player-broker/accounttransactions/"+user,
                type: 'GET',
                success: function (res) {
                	
                   $.each(res,function(key,transaction){
                	   $("#account_records > tbody:last-child").append('<tr><td>'+transaction.time+'</td><td>'+transaction.transaction_amount+'</td><td>'+transaction.transaction_type+'</td><td>'+transaction.balance_after+'</td></tr>');
                   });
                },
            });
    		$("#user_shares >tbody").empty();
    		$.ajax({
                url: "http://"+host+"/47SMSG/rest/game/player-stock/"+user,
                type: 'GET',
                success: function (res) {
                	
                   $.each(res,function(key,stock){
                	   $("#user_shares > tbody:last-child").append('<tr><td>'+stock.company+'</td><td>'+stock.stock_Count+'</td><td>'+stock.stock_Value+'</td></tr>');
                   });
                },
            });
    		$("#stock_history >thead").empty();
    		$("#stock_history >tbody").empty();
    		$.ajax({
      	        url: "http://"+host+"/47SMSG/rest/game/company-trends",
      	        type: 'GET',
      	        success: function (res) {
      	           var round=$("#this_round").text();
      	         $("#stock_history >thead").append('<tr>');
      	        	 $("#stock_history >thead").append('<th>Company</th>');
      	        	 for(i=1;i<=round;i++){
      	        		$("#stock_history >thead").append('<th> '+i+'</th>');
      	        	 }
      	        	$("#stock_history >thead").append('</tr>');
      	        	$.each(res,function(key,company){
      	        		$("#stock_history >tbody").append('<tr>');
      	        		$("#stock_history >tbody").append('<td>'+company.company_name+'</th>');
      	        		for(i=1;i<=round;i++){
          	        		$("#stock_history >tbody").append('<td>'+company.round_values[i-1]+'</td>');
          	        	 }
      	        		$("#stock_history >tbody").append('</tr>');
      	        	});
      	        },
      	   });
		},6000);
		
		$("#buy_button").click(function(){
    		if($("#amount").val()>0){
    			$.ajax({
                    url: "http://"+host+"/47SMSG/rest/player-broker/buy/"+user+'/'+$( "#company :selected" ).val()+'/'+$("#amount").val(),
                    type: 'GET',
                    success: function (res) {
                    	$("#amount").val('');
                    	$("#user_shares >tbody").empty();
                		$("#sellcompany").empty();
                		$.ajax({
                            url: "http://"+host+"/47SMSG/rest/game/player-stock/"+user,
                            type: 'GET',
                            success: function (res) {
                            	
                            	$("#sellcompany").append('<option></option>');
                               $.each(res,function(key,stock){
                            	   $("#sellcompany").append('<option value="'+stock.company+'">'+stock.company+'</option>');
                            	   $("#user_shares > tbody:last-child").append('<tr><td>'+stock.company+'</td><td>'+stock.stock_Count+'</td><td>'+stock.stock_Value+'</td></tr>');
                                   
                               });
                            },
                        });
                       if(res!=true){
                    	   alert("Not Completed")
                       }
                    },
                });
    		}else{
    			alert("Please enter a number greater than 0");
    		}
    		
    	});
    	
    	$("#sell_button").click(function(){
    		
    		$.ajax({
                url: "http://"+host+"/47SMSG/rest/player-broker/sell/"+user+'/'+$("#sellcompany :selected" ).val()+'/'+$("#sellamount :selected").val(),
                type: 'GET',
                success: function (res) {
                   if(res!=true){
                	   alert("Action could not performed")
                   }
                },
            });
    	});
    });
    </script>

</body>
</html>
